\begin{tikzpicture}[x=1.5mm, y=1.5mm, auto]
    % Image dimensions.
    \draw [Latex-Latex] (0, -21) -- node [below, font=\footnotesize] {$w$} (20, -21);
    \draw [Latex-Latex] (21, 0) -- node [font=\footnotesize] {$h$} (21, -20);
    \draw [Latex-Latex] (-1, -21) -- node [below, font=\footnotesize, rotate=315] {$3$} (-3, -19);

    % Do a convolution.  Overlay the filter on the image.
    \foreach \depth in {2, ..., 0} {
        \image{-\depth}{\depth}
        \filter{0 - \depth}{\depth}
    }

    % Draw the feature map below and connect to the image.  Make multiple feature maps.
    \foreach \depth in {5, ..., 0} {
        \featuremap{4 - \depth}{-30 + \depth}{16}
    }

    \featuremap{4}{-30}{1}
    \draw [path] (2.5, -2.5) -- ( 4.5, -30.5);

    % Feature map dimensions.
    \draw [Latex-Latex] (4, -47) -- node [below, font=\footnotesize] {$w - m + 1$} (20, -47);
    \draw [Latex-Latex] (21, -30) -- node [below, font=\footnotesize, rotate=90] {$h - m + 1$} (21, -46);
    \draw [Latex-Latex] (3, -47) -- node [below, font=\footnotesize, rotate=315] {$k$} (-2, -42);
\end{tikzpicture}
%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../nn"
%%% End:
